
> monisagent@9.1.0 lint
> eslint ./*.{js,mjs} lib test bin examples


/Users/revans/code/node-monisagent/api.js
   512:40  error    Refactor this function to reduce its Cognitive Complexity from 21 to the 15 allowed                          sonarjs/cognitive-complexity
  1407:10  error    Refactor this function to reduce its Cognitive Complexity from 17 to the 15 allowed                          sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/adaptive-sampler.js

/Users/revans/code/node-monisagent/lib/agent.js
   727:10  error    Refactor this function to reduce its Cognitive Complexity from 23 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/collector/api.js
  108:34  error    Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed          sonarjs/cognitive-complexity
  110:25  error    Define a constant instead of duplicating this literal 11 times                               sonarjs/no-duplicate-string
  212:33  error    Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed          sonarjs/cognitive-complexity
  657:12  error    This branch's code block is the same as the block for the branch on line 623                 sonarjs/no-duplicated-branches

/Users/revans/code/node-monisagent/lib/collector/facts.js
  145:22  error    Immediately return this expression instead of assigning it to the temporary variable "identifier"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/collector/http-agents.js

/Users/revans/code/node-monisagent/lib/collector/parse-response.js

/Users/revans/code/node-monisagent/lib/collector/remote-method.js
  252:3   error    Merge this if statement with the nested one                                                           sonarjs/no-collapsible-if
  351:21  error    Immediately return this expression instead of assigning it to the temporary variable "formatted"      sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/collector/serverless.js

/Users/revans/code/node-monisagent/lib/config/attribute-filter.js
  131:37  error    Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/config/default.js

/Users/revans/code/node-monisagent/lib/config/harvest-config-validator.js
  16:5  error  Immediately return this expression instead of assigning it to the temporary variable "isValid"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/config/index.js
   271:32  error    Refactor this function to reduce its Cognitive Complexity from 23 to the 15 allowed  sonarjs/cognitive-complexity
   272:3   error    Reduce the number of non-empty switch cases from 36 to at most 30                    sonarjs/max-switch-cases
   341:21  error    Define a constant instead of duplicating this literal 3 times                        sonarjs/no-duplicate-string
  1071:37  error    Refactor this function to reduce its Cognitive Complexity from 29 to the 15 allowed  sonarjs/cognitive-complexity
  1178:39  error    Refactor this function to reduce its Cognitive Complexity from 29 to the 15 allowed  sonarjs/cognitive-complexity
  1312:10  error    Refactor this function to reduce its Cognitive Complexity from 24 to the 15 allowed  sonarjs/cognitive-complexity
  1407:30  error    Refactor this function to reduce its Cognitive Complexity from 27 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/environment.js
  421:40  error    Define a constant instead of duplicating this literal 5 times  sonarjs/no-duplicate-string

/Users/revans/code/node-monisagent/lib/errors/error-collector.js
  118:3  error    Refactor this function to reduce its Cognitive Complexity from 25 to the 15 allowed               sonarjs/cognitive-complexity
  265:3  error    Refactor this function to reduce its Cognitive Complexity from 23 to the 15 allowed               sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/errors/helper.js
   24:5  error  Merge this if statement with the nested one  sonarjs/no-collapsible-if
   32:5  error  Merge this if statement with the nested one  sonarjs/no-collapsible-if
  126:5  error  Merge this if statement with the nested one  sonarjs/no-collapsible-if

/Users/revans/code/node-monisagent/lib/errors/index.js
   52:10  error    Refactor this function to reduce its Cognitive Complexity from 22 to the 15 allowed                sonarjs/cognitive-complexity
  104:21  error    Define a constant instead of duplicating this literal 3 times                                      sonarjs/no-duplicate-string
  139:22  error    Immediately return this expression instead of assigning it to the temporary variable "errorEvent"  sonarjs/prefer-immediate-return
  145:10  error    Refactor this function to reduce its Cognitive Complexity from 17 to the 15 allowed                sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/esm-shim.mjs

/Users/revans/code/node-monisagent/lib/grpc/connection.js
  363:20  error    Immediately return this expression instead of assigning it to the temporary variable "client"                                                   sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/header-attributes.js

/Users/revans/code/node-monisagent/lib/header-processing.js
  40:30  error    Immediately return this expression instead of assigning it to the temporary variable "convertedQueueTime"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/instrumentation/@node-redis/client.js
  13:36  error  Refactor this function to reduce its Cognitive Complexity from 20 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/amqplib.js
  116:10  error  Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/cassandra-driver.js

/Users/revans/code/node-monisagent/lib/instrumentation/core/async_hooks.js
  37:17  error  Immediately return this expression instead of assigning it to the temporary variable "hooks"  sonarjs/prefer-immediate-return
  93:10  error  Refactor this function to reduce its Cognitive Complexity from 21 to the 15 allowed           sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/core/globals.js
  40:7  error  Merge this if statement with the nested one  sonarjs/no-collapsible-if

/Users/revans/code/node-monisagent/lib/instrumentation/core/http-outbound.js
   33:18  error    Refactor this function to reduce its Cognitive Complexity from 40 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/core/http.js
   41:10  error    Refactor this function to reduce its Cognitive Complexity from 44 to the 15 allowed          sonarjs/cognitive-complexity
  241:58  error    Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed          sonarjs/cognitive-complexity
  259:7   error    Merge this if statement with the nested one                                                  sonarjs/no-collapsible-if
  372:10  error    Refactor this function to reduce its Cognitive Complexity from 19 to the 15 allowed          sonarjs/cognitive-complexity
  495:22  error    Immediately return this expression instead of assigning it to the temporary variable "sock"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/instrumentation/core/timers.js
  10:10  error  Refactor this function to reduce its Cognitive Complexity from 19 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/fastify.js
  151:33  error    Immediately return this expression instead of assigning it to the temporary variable "newMiddlewareFunction"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/instrumentation/fastify/spec-builders.js

/Users/revans/code/node-monisagent/lib/instrumentation/hapi.js
  27:10  error  Merge this if statement with the nested one                                          sonarjs/no-collapsible-if
  67:40  error  Refactor this function to reduce its Cognitive Complexity from 20 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/hapi/hapi.js
  30:10  error  Refactor this function to reduce its Cognitive Complexity from 68 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/memcached.js

/Users/revans/code/node-monisagent/lib/instrumentation/mongodb.js

/Users/revans/code/node-monisagent/lib/instrumentation/mongodb/common.js
  208:10  error    Refactor this function to reduce its Cognitive Complexity from 18 to the 15 allowed             sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/mongodb/v2-mongo.js

/Users/revans/code/node-monisagent/lib/instrumentation/mongodb/v3-mongo.js

/Users/revans/code/node-monisagent/lib/instrumentation/mongodb/v4-mongo.js

/Users/revans/code/node-monisagent/lib/instrumentation/nr-winston-transport.js
  66:3  error  This function expects 1 argument, but 2 were provided  sonarjs/no-extra-arguments

/Users/revans/code/node-monisagent/lib/instrumentation/pino/pino.js

/Users/revans/code/node-monisagent/lib/instrumentation/promise.js
   69:18  error    Refactor this function to reduce its Cognitive Complexity from 101 to the 15 allowed  sonarjs/cognitive-complexity
  146:58  error    Define a constant instead of duplicating this literal 3 times                         sonarjs/no-duplicate-string
  222:17  error    This function expects 1 argument, but 2 were provided                                 sonarjs/no-extra-arguments
  455:23  error    Refactor this function to reduce its Cognitive Complexity from 17 to the 15 allowed   sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/redis.js
  11:18  error  Refactor this function to reduce its Cognitive Complexity from 52 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/instrumentation/undici.js
   27:18  error    Refactor this function to reduce its Cognitive Complexity from 53 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/metrics/index.js

/Users/revans/code/node-monisagent/lib/metrics/mapper.js

/Users/revans/code/node-monisagent/lib/metrics/metric-aggregator.js
   46:21  error    Immediately return this expression instead of assigning it to the temporary variable "payload"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/metrics/names.js
  137:29  error  Define a constant instead of duplicating this literal 3 times  sonarjs/no-duplicate-string
  144:29  error  Define a constant instead of duplicating this literal 3 times  sonarjs/no-duplicate-string
  151:11  error  Define a constant instead of duplicating this literal 3 times  sonarjs/no-duplicate-string
  219:12  error  Define a constant instead of duplicating this literal 3 times  sonarjs/no-duplicate-string

/Users/revans/code/node-monisagent/lib/metrics/normalizer.js
  117:45  error    Refactor this function to reduce its Cognitive Complexity from 24 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/metrics/normalizer/rule.js

/Users/revans/code/node-monisagent/lib/metrics/normalizer/tx_segment.js
  35:43  error    Refactor this function to reduce its Cognitive Complexity from 17 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/parse-proc-cpuinfo.js
  12:44  error  Define a constant instead of duplicating this literal 4 times  sonarjs/no-duplicate-string

/Users/revans/code/node-monisagent/lib/prioritized-attributes.js

/Users/revans/code/node-monisagent/lib/serverless/api-gateway.js

/Users/revans/code/node-monisagent/lib/serverless/aws-lambda.js
   68:3   error  Refactor this function to reduce its Cognitive Complexity from 29 to the 15 allowed                     sonarjs/cognitive-complexity
  351:27  error  Immediately return this expression instead of assigning it to the temporary variable "lowercaseObject"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/shim/conglomerate-shim.js

/Users/revans/code/node-monisagent/lib/shim/constants.js

/Users/revans/code/node-monisagent/lib/shim/datastore-shim.js
  396:10  error    Refactor this function to reduce its Cognitive Complexity from 19 to the 15 allowed  sonarjs/cognitive-complexity
  709:10  error    Refactor this function to reduce its Cognitive Complexity from 52 to the 15 allowed  sonarjs/cognitive-complexity
  881:10  error    Refactor this function to reduce its Cognitive Complexity from 23 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/shim/index.js

/Users/revans/code/node-monisagent/lib/shim/message-shim.js
  347:10  error    Refactor this function to reduce its Cognitive Complexity from 60 to the 15 allowed                                                          sonarjs/cognitive-complexity
  566:10  error    Refactor this function to reduce its Cognitive Complexity from 72 to the 15 allowed                                                          sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/shim/promise-shim.js
  373:10  error    Refactor this function to reduce its Cognitive Complexity from 30 to the 15 allowed  sonarjs/cognitive-complexity
  461:10  error    Refactor this function to reduce its Cognitive Complexity from 17 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/shim/shim.js
   471:5   error    Remove this use of the output from "_specToFunction"; "_specToFunction" doesn't return anything  sonarjs/no-use-of-empty-return-value
   591:10  error    Refactor this function to reduce its Cognitive Complexity from 32 to the 15 allowed              sonarjs/cognitive-complexity
   600:12  error    Remove this use of the output from "_specToFunction"; "_specToFunction" doesn't return anything  sonarjs/no-use-of-empty-return-value
   814:10  error    Refactor this function to reduce its Cognitive Complexity from 59 to the 15 allowed              sonarjs/cognitive-complexity
  1110:19  error    Immediately return this expression instead of assigning it to the temporary variable "wrapped"   sonarjs/prefer-immediate-return
  1936:10  error    Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed              sonarjs/cognitive-complexity
  1994:10  error    Refactor this function to reduce its Cognitive Complexity from 27 to the 15 allowed              sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/shim/transaction-shim.js

/Users/revans/code/node-monisagent/lib/shim/webframework-shim.js
   373:10  error    Refactor this function to reduce its Cognitive Complexity from 35 to the 15 allowed  sonarjs/cognitive-complexity
   696:10  error    Refactor this function to reduce its Cognitive Complexity from 69 to the 15 allowed  sonarjs/cognitive-complexity
   970:10  error    Refactor this function to reduce its Cognitive Complexity from 23 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/shimmer.js

/Users/revans/code/node-monisagent/lib/spans/map-to-streaming-type.js
  46:3  error  Remove this redundant jump  sonarjs/no-redundant-jump

/Users/revans/code/node-monisagent/lib/spans/streaming-span-event-aggregator.js
  64:5  error    Remove this redundant jump                                                 sonarjs/no-redundant-jump

/Users/revans/code/node-monisagent/lib/spans/streaming-span-event.js
   98:23  error    Immediately return this expression instead of assigning it to the temporary variable "formatted"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/stats/index.js

/Users/revans/code/node-monisagent/lib/system-info.js
   24:10  error  Refactor this function to reduce its Cognitive Complexity from 29 to the 15 allowed  sonarjs/cognitive-complexity
  113:37  error  Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed  sonarjs/cognitive-complexity
  181:38  error  This branch's code block is the same as the block for the branch on line 177         sonarjs/no-duplicated-branches

/Users/revans/code/node-monisagent/lib/timer.js

/Users/revans/code/node-monisagent/lib/transaction/dt-payload.js

/Users/revans/code/node-monisagent/lib/transaction/handle.js

/Users/revans/code/node-monisagent/lib/transaction/index.js
   406:10  error    Refactor this function to reduce its Cognitive Complexity from 19 to the 15 allowed                               sonarjs/cognitive-complexity
   428:58  error    Define a constant instead of duplicating this literal 6 times                                                     sonarjs/no-duplicate-string
  1030:10  error    Refactor this function to reduce its Cognitive Complexity from 29 to the 15 allowed                               sonarjs/cognitive-complexity
  1061:37  error    Define a constant instead of duplicating this literal 3 times                                                     sonarjs/no-duplicate-string
  1078:37  error    Define a constant instead of duplicating this literal 4 times                                                     sonarjs/no-duplicate-string

/Users/revans/code/node-monisagent/lib/transaction/name-state.js

/Users/revans/code/node-monisagent/lib/transaction/trace/aggregator.js
  275:5  error    Merge this if statement with the nested one                  sonarjs/no-collapsible-if
  288:5  error    Replace this if-then-else flow by a single return statement  sonarjs/prefer-single-boolean-return

/Users/revans/code/node-monisagent/lib/transaction/trace/index.js
   75:38  error    Refactor this function to reduce its Cognitive Complexity from 19 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/transaction/tracecontext.js
  377:3   error    Refactor this function to reduce its Cognitive Complexity from 20 to the 15 allowed                sonarjs/cognitive-complexity
  573:24  error    Immediately return this expression instead of assigning it to the temporary variable "intrinsics"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/transaction/tracer/index.js
  320:18  error  Define a constant instead of duplicating this literal 4 times                                  sonarjs/no-duplicate-string
  332:20  error  Define a constant instead of duplicating this literal 4 times                                  sonarjs/no-duplicate-string
  336:18  error  Define a constant instead of duplicating this literal 3 times                                  sonarjs/no-duplicate-string
  388:22  error  Immediately return this expression instead of assigning it to the temporary variable "result"  sonarjs/prefer-immediate-return

/Users/revans/code/node-monisagent/lib/transaction/transaction-event-aggregator.js
  90:31  error  Immediately return this expression instead of assigning it to the temporary variable "eventPayloadPairs"  sonarjs/prefer-immediate-return
/Users/revans/code/node-monisagent/lib/util/deep-equal.js
  68:10  error    Refactor this function to reduce its Cognitive Complexity from 35 to the 15 allowed  sonarjs/cognitive-complexity

/Users/revans/code/node-monisagent/lib/util/hashes.js
  44:18  error  Immediately return this expression instead of assigning it to the temporary variable "retval"  sonarjs/prefer-immediate-return

